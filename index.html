<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>World/Marker AR Placement</title>
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
    <style>
        body { margin: 0; overflow: hidden }
        #controls {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            color: white;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="controls">
        <button onclick="placeObject()">Place Here</button>
        <p id="status">Initializing...</p>
    </div>

    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false; trackingMethod: best;"
        vr-mode-ui="enabled: false"
    >
        <!-- Marker Tracking Version (comment/uncomment) -->
        <!--
        <a-marker preset="hiro">
            <a-entity id="virtual-object" glb-model="url(https://your-model.glb)"></a-entity>
        </a-marker>
        -->

        <!-- World Tracking Version -->
        <a-entity id="virtual-object" glb-model="url(https://your-model.glb)" visible="false"></a-entity>
        
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        // ======================
        // WORLD TRACKING VERSION
        // ======================
        let objectPlaced = false;
        const modelScale = 0.5; // Adjust based on your model size

        function placeObject() {
            if(!objectPlaced) {
                const scene = document.querySelector('a-scene');
                const object = document.querySelector('#virtual-object');
                
                // Get device orientation
                scene.systems["arjs"].getSource().copyWorldPosition(object.object3D);
                
                // Set scale and visibility
                object.setAttribute('scale', `${modelScale} ${modelScale} ${modelScale}`);
                object.setAttribute('visible', 'true');
                objectPlaced = true;
                
                document.getElementById('status').textContent = "Object placed!";
            }
        }

        // =====================
        // COMMON INITIALIZATION
        // =====================
        document.querySelector('a-scene').addEventListener('loaded', () => {
            // Check camera support
            if(!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {
                document.getElementById('status').textContent = "AR not supported on this device";
                return;
            }

            // Start AR session
            navigator.mediaDevices.getUserMedia({ video: true })
                .then(() => {
                    document.getElementById('status').textContent = "Point camera and tap 'Place Here'";
                })
                .catch(() => {
                    document.getElementById('status').textContent = "Camera access denied";
                });
        });

        // Add test object for verification
        const testBox = document.createElement('a-box');
        testBox.setAttribute('color', 'red');
        testBox.setAttribute('position', '0 0 -1');
        testBox.setAttribute('scale', '0.2 0.2 0.2');
        document.querySelector('a-scene').appendChild(testBox);
    </script>
</body>
</html>
